package com.noob.algorithm.daily.plan03.hot100_daily.day03.p005;

import java.util.Comparator;
import java.util.PriorityQueue;

/**
 * ğŸ”´ 239 æ»‘åŠ¨çª—å£æœ€å¤§å€¼ - https://leetcode.cn/problems/sliding-window-maximum/submissions/598655671/
 */
public class Solution239_02 {

    /**
     * æ€è·¯åˆ†æï¼š
     * ç»™å®šæ•´æ•°æ•°ç»„ numsï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º k çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£å†…çš„ k ä¸ªæ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½
     * è¿”å› æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼
     * - å †ï¼šä¼˜å…ˆçº§æ¦‚å¿µ
     */
    public int[] maxSlidingWindow(int[] nums, int k) {

        int n = nums.length;


        // æ„å»ºå †ä½œä¸ºæ»‘åŠ¨çª—å£çš„è¾…åŠ©å®¹å™¨ï¼Œå…ƒç´ æŒ‰ç…§å…ƒç´ å¤§å°ã€ç´¢å¼•å¤§å°çš„ä»å°åˆ°å¤§çš„é¡ºåºè¿›è¡Œæ’åºå…¥å †
        PriorityQueue<int[]> pq = new PriorityQueue<>(new Comparator<int[]>() {
            // å®šä¹‰int[]{a,b} åˆ†åˆ«å­˜å‚¨å…ƒç´ å€¼ã€ç´¢å¼•
            @Override
            public int compare(int[] o1, int[] o2) {
                // å…ˆæ¯”è¾ƒå…ƒç´ å€¼ï¼Œåæ¯”è¾ƒå…ƒç´ ç´¢å¼•
                return o1[0] == o2[0] ? o2[1] - o1[1] : o2[0] - o1[0];
            }
        });

        // åˆå§‹åŒ–kä¸ªå…ƒç´ å…¥å †
        for (int i = 0; i < k; i++) {
            pq.offer(new int[]{nums[i], i});
        }

        // å®šä¹‰ç»“æœé›†åˆ
        int[] ans = new int[n - k + 1];
        ans[0] = pq.peek()[0]; // ç¬¬ä¸€ä¸ªå…ƒç´ å³ä¸ºæœ€å¤§å€¼
        int cur = 1; // curä¸ºå½“å‰å¾…å¡«å……çš„æŒ‡é’ˆä½ç½®

        // éå†å‰©ä½™å…ƒç´ å¤„ç†æœ€å¤§å€¼æ•°æ®
        for (int i = k; i < n; i++) {
            // å…ƒç´ åŠ å…¥
            pq.offer(new int[]{nums[i], i});
            /**
             * æ ¡éªŒå½“å‰å †é¡¶å…ƒç´ å’Œcurçš„ç›¸å¯¹ä½ç½®
             * - curç›¸å½“äºæ»‘åŠ¨çª—å£çš„å·¦è¾¹ç•Œ
             * - å †é¡¶å…ƒç´ è¡¨ç¤ºå½“å‰æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼Œéœ€ç¡®ä¿å…¶ç´¢å¼•åœ¨æœ‰æ•ˆçš„çª—å£èŒƒå›´å†…ï¼ˆå³[cur,rightï¼‰,æŒ‰ç…§é¡ºåºéå†å·²ç»ç¡®ä¿äº†å³è¾¹ç•Œï¼Œæ­¤å¤„åˆ™åªéœ€è¦æ ¡éªŒå·¦è¾¹ç•Œï¼Œå¦‚æœè¶Šç•Œåˆ™å‰”é™¤è¿™ä¸ªå¯èƒ½çš„æœ€å¤§å€¼ï¼‰
             * å³å³ä¾§æ‰©å±•ï¼Œå·¦ä¾§é™åˆ¶ï¼Œè®°å½•å½“å‰å †çš„æœ‰åºæ€§ï¼Œå¹¶ç¡®ä¿æœ€å¤§å€¼å¯¹åº”çš„ç´¢å¼•åœ¨çª—å£çš„æœ‰æ•ˆèŒƒå›´å†…ï¼Œä¹Ÿä¸éœ€è¦é‡å¤å¯¹ç°æœ‰çª—å£å†…çš„å…ƒç´ é‡å¤æ’åº
             */
            // æ ¡éªŒcurä¸å †é¡¶å…ƒç´ ç´¢å¼•çš„ç›¸å¯¹ä½ç½®,å¦‚æœæœ€å¤§å€¼æ²¡æœ‰å‡ºç°åœ¨æœ‰æ•ˆçš„çª—å£èŒƒå›´ï¼Œåˆ™ä¸æ–­å°†å…¶å‰”é™¤(æ­¤å¤„éœ€æ³¨æ„topIdxçš„æ›´æ–°)
            while (pq.peek()[1] < cur) {
                pq.poll();
            }

            /*
            if (topIdx >= cur) {
                // æœ€å¤§å€¼å‡ºç°åœ¨æœ‰æ•ˆçš„çª—å£èŒƒå›´ï¼Œè®°å½•è¯¥æœ€å¤§å€¼
                ans[cur++] = pq.peek()[0];
            }
             */

            // æœ€å¤§å€¼å‡ºç°åœ¨æœ‰æ•ˆçš„çª—å£èŒƒå›´ï¼Œè®°å½•è¯¥æœ€å¤§å€¼
            ans[cur++] = pq.peek()[0];
        }

        // è¿”å›ç»“æœ
        return ans;
    }


    public static void main(String[] args) {
        Solution239_02 s = new Solution239_02();
        s.maxSlidingWindow(new int[]{1, 3, -1, -3, 5, 3, 6, 7}, 3);
    }


}

package com.noob.algorithm.daily.plan02.day09.p029;

/**
 * ğŸ”´ 188 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV - https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/description/
 */
public class Solution188_01 {

    /**
     * k æ¬¡ ä¹°å…¥å–å‡º
     * dp[i][0] é»˜è®¤çŠ¶æ€
     * dp[i][1] ç¬¬1æ¬¡æŒæœ‰ dp[i][1] = max{dp[i-1][1],dp[i-1][0] - prices[i]}
     * dp[i][2] ç¬¬1æ¬¡ä¸æŒæœ‰ dp[i][2] = max{dp[i-1][2],dp[i-1][1] + prices[i]}
     * dp[i][3] ç¬¬2æ¬¡æŒæœ‰ dp[i][3] = max{dp[i-1][3],dp[i-1][2] - prices[i]}
     * dp[i][4] ç¬¬2æ¬¡ä¸æŒæœ‰ dp[i][4] = max{dp[i-1][4],dp[i-1][3] + prices[i]}
     * <p>
     * ç¬¬kæ¬¡ï¼šå…±2K+1ä¸ªçŠ¶æ€
     * dp[i][2k-1] ç¬¬kæ¬¡æŒæœ‰ dp[i][2k-1] = max{dp[i-1][2k-1],dp[i-1][2k-2] - prices[i]}
     * dp[i][2k] ç¬¬kæ¬¡ä¸æŒæœ‰ dp[i][2k] = max{dp[i-1][2k],dp[i-1][2k-1] + prices[i]}
     */
    public int maxProfit(int k, int[] prices) {
        int n = prices.length;
        // 1.dp å®šä¹‰
        int[][] dp = new int[n][2 * k + 1];

        /**
         * 2.dp é€’æ¨
         */

        // 3.dp åˆå§‹åŒ– dp[0][0...k...2k]  æ­¤å¤„éå†çš„ç»´åº¦æ˜¯å¯¹å®Œæ•´çš„çŠ¶æ€èŒƒå›´
        for (int i = 0; i < 2 * k + 1; i++) {
            if (i == 0) {
                dp[0][0] = 0;
            } else if (i % 2 == 1) {
                dp[0][i] = -prices[0]; // è¡¨ç¤ºæŒæœ‰è‚¡ç¥¨çŠ¶æ€ä¸‹ï¼ˆæ—¥å†…ä¹°å…¥å–å‡ºæŠµæ¶ˆï¼Œæœ€ç»ˆä¿ç•™æŒæœ‰è‚¡ç¥¨çŠ¶æ€ï¼‰
            }
            if (i % 2 == 0) {
                dp[0][i] = 0; // è¡¨ç¤ºæœªæŒæœ‰è‚¡ç¥¨çŠ¶æ€ä¸‹ï¼ˆæ—¥å†…ä¹°å…¥å–å‡ºæŠµæ¶ˆï¼Œæœ€ç»ˆä¿ç•™ä¸æŒæœ‰è‚¡ç¥¨çŠ¶æ€ï¼‰
            }
        }
        /*
        // æ­¤å¤„éå†çš„ç»´åº¦æ˜¯é’ˆå¯¹æ¬¡æ•°kç„¶ååšç›¸åº”è½¬åŒ–ï¼ˆè½¬åŒ–æœªå¯¹åº”çš„çŠ¶æ€ï¼‰
        dp[0][0] = 0; // æ—¥å†…ä¸åšä»»ä½•æ“ä½œ
        for (int x = 1; x <= k; x++) {
            dp[0][2 * x - 1] = 0 - prices[0]; // ç¬¬kæ¬¡æŒæœ‰ï¼Œä¹°å…¥è‚¡ç¥¨
            dp[0][2 * x] = 0; // ç¬¬kæ¬¡ä¸æŒæœ‰ï¼Œæ—¥å†…æ‰§è¡Œäº†ä¹°å…¥å–å‡ºæ“ä½œï¼Œä¸€æ­£ä¸€è´ŸæŠµæ¶ˆ
        }
         */

        // 4.dp æ„å»º
        for (int i = 1; i < n; i++) {
            // æ­¤å¤„çš„éå†ç»´åº¦æ˜¯æ¬¡æ•°k
            for (int x = 1; x <= k; x++) {
                dp[i][0] = 0;
                dp[i][2 * x - 1] = Math.max(dp[i - 1][2 * x - 1], dp[i - 1][2 * x - 2] - prices[i]);
                dp[i][2 * x] = Math.max(dp[i - 1][2 * x], dp[i - 1][2 * x - 1] + prices[i]);
            }
        }

        // è¿”å›æœ€åä¸€å¤©æœªæŒæœ‰è‚¡ç¥¨çŠ¶æ€ä¸‹çš„æœ€å¤§å€¼
        return dp[n - 1][2 * k];
    }
}

package com.noob.algorithm.dmsxl.leetcode.q1365;

import java.util.Arrays;
import java.util.Comparator;

/**
 * ğŸŸ¢ 1365 æœ‰å¤šå°‘å°äºå½“å‰æ•°å­—çš„æ•°å­—
 */
public class Solution2 {

    // æ’åºæ³•
    public int[] smallerNumbersThanCurrent(int[] nums) {
        int len = nums.length; // å®šä¹‰æ•°ç»„é•¿åº¦
        int[] res = new int[nums.length]; // å®šä¹‰ç»Ÿè®¡ç»“æœæ•°ç»„

        // å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºå®ƒçš„å…ƒç´ (æ•°ç»„å…ƒç´ å¯èƒ½é‡å¤ï¼Œæ­¤å¤„ä¸é€‚åˆç”¨mapå¤„ç†ï¼Œå¯ä»¥å€ŸåŠ©äºŒç»´æ•°ç»„æ„å»ºæ•°ç»„å…ƒç´ ä¸åŸæœ‰ç´¢å¼•åæ ‡çš„å…³ç³»)
        int[][] numMap = new int[len][2]; // [{ å…ƒç´ å€¼,å¯¹åº”åŸæœ‰åæ ‡ }]
        for (int i = 0; i < len; i++) {
            numMap[i][0] = nums[i];
            numMap[i][1] = i;
        }

        // å¯¹äºŒç»´æ•°ç»„è¿›è¡Œæ’åºï¼ˆä»å°åˆ°å¤§ï¼‰,åˆ™æ­¤æ—¶ç´¢å¼•æ•°å­—å¯¹åº”ä¸ºå‰é¢æœ‰å¤šå°‘ä¸ªæ¯”å®ƒå°çš„æ•°å­—
        Arrays.sort(numMap, new Comparator<int[]>() {
            @Override
            public int compare(int[] o1, int[] o2) {
                return o1[0] - o2[0]; // æ ¹æ®å…ƒç´ å€¼å¤§å°"ä»å°åˆ°å¤§"è¿›è¡Œæ’åº
            }
        });

        /**
         * éå†æ¯ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°ç¬¬1ä¸ªæ¯”å®ƒå°çš„å…ƒç´ (å› ä¸ºæ­¤å¤„å¯¹æ•°ç»„è¿›è¡Œäº†æ’åºï¼Œæ‰€ä»¥å½“å‡ºç°ä¸è¿ç»­çš„æƒ…å†µåˆ™éœ€å‡ºç°äº†æ¯”å®ƒå°çš„æ•°)
         * æ•°ç»„æœ¬èº«æœ‰åºï¼Œå¦‚æœå…ƒç´ ä¸é‡å¤çš„æƒ…å†µä¸‹ï¼Œåˆ™ç´¢å¼•å€¼å³ä¸ºæ¯”å½“å‰å…ƒç´ å°çš„æ•°å­—ä¸ªæ•°
         * ä½†æ˜¯å¦‚æœå…ƒç´ å‡ºç°é‡å¤ï¼Œé’ˆå¯¹é‡å¤çš„æƒ…å†µåˆ™éœ€è¦é™å®šå…¶ä¸å‰é¢å‡ºç°çš„ä¿æŒä¸€è‡´
         */
        int prev = -1; // è®°å½•ç¬¬ä¸€ä¸ªå‡ºç°çš„æ•°å­—æ¯”å®ƒå°çš„æ•°å­—ä¸ªæ•°ï¼ˆå¦‚æœæ˜¯è¿ç»­å‡ºç°åˆ™ä¸å˜ï¼‰
        for (int x = 0; x < numMap.length; x++) {
            // å¦‚æœåˆå§‹åŒ–çŠ¶æ€ä¸‹æˆ–è€…æ˜¯å‡ºç°ä¸è¿ç»­çš„æƒ…å†µï¼Œåˆ™è®°å½•è¿™ä¸ªprev
            if (prev == -1 || numMap[x - 1][0] != numMap[x][0]) {
                prev = x; // ç´¢å¼•å³ä¸ºç›¸åº”ç»Ÿè®¡
            }
            // å¤„ç†å¯¹åº”ç´¢å¼•ä½ç½®çš„ç»“æœï¼ˆæ ¹æ®åŸæ¥çš„ç´¢å¼•ä½ç½®å°è£…ç»“æœï¼‰
            res[numMap[x][1]] = prev;
        }

        // è¿”å›å¤„ç†ç»“æœ
        return res;
    }

}
